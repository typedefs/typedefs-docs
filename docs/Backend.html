<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>IdrisDoc: Backend</title><link type="text/css" rel="stylesheet" href="../styles.css"></head><body class="namespace"><div class="wrapper"><header><strong>IdrisDoc</strong>: Backend<nav><a href="../index.html">Index</a></nav></header><div class="container"><h1>Backend</h1><dl class="decls"><dt id="Backend.Backend"><span class="word">interface&nbsp;</span><span class="name type" title="Backend.Backend">Backend</span><span class="signature">&nbsp;</span></dt><dd><p>Interface for codegens. <code>lang</code> is a type representing (the syntactic structure of)<br />
a type declaration in the target language.</p>
<dl class="decls"><dt id="Backend.generateTyDefs"><span class="name function" title="Backend.generateTyDefs">generateTyDefs</span><span class="word">&nbsp;:&nbsp;</span><span class="signature"><a class="type" title="Backend.Backend" href="Backend.html#Backend.Backend">Backend</a> <span class="implicit boundvar" title="">lang</span> =>
<a class="function" title="Backend.Env" href="Backend.html#Backend.Env">Env</a> <span class="implicit boundvar" title="">n</span> ->
<a class="type" title="Typedefs.TDef" href="Typedefs.html#Typedefs.TDef">TDef</a> <span class="implicit boundvar" title="">n</span> ->
<a class="type" title="Prelude.List.List" href="Prelude.List.html#Prelude.List.List">List</a> <span class="implicit boundvar" title="">lang</span></span></dt><dd><p>Given a TDef and a matching environment, generate a list of type definitions<br />
in the target language.</p>
</dd><dt id="Backend.generateCode"><span class="name function" title="Backend.generateCode">generateCode</span><span class="word">&nbsp;:&nbsp;</span><span class="signature"><a class="type" title="Backend.Backend" href="Backend.html#Backend.Backend">Backend</a> <span class="implicit boundvar" title="">lang</span> =>
<span class="implicit boundvar" title="">lang</span> ->
<a class="type" title="Text.PrettyPrint.WL.Core.Doc" href="Text.PrettyPrint.WL.Core.html#Text.PrettyPrint.WL.Core.Doc">Doc</a></span></dt><dd><p>Given a type definition in the target language, generate its code.</p>
</dd><dt id="Backend.freshEnv"><span class="name function" title="Backend.freshEnv">freshEnv</span><span class="word">&nbsp;:&nbsp;</span><span class="signature"><a class="type" title="Backend.Backend" href="Backend.html#Backend.Backend">Backend</a> <span class="implicit boundvar" title="">lang</span> =>
(<span class="boundvar" title="">n</span> : <a class="type" title="Prelude.Nat.Nat" href="Prelude.Nat.html#Prelude.Nat.Nat">Nat</a>) ->
<a class="function" title="Backend.Env" href="Backend.html#Backend.Env">Env</a> <span class="boundvar" title="">n</span></span></dt><dd><p>Generate a new environment with n free names.</p>
</dd></dl></dd><dt id="Backend.Decl"><span class="word">record&nbsp;</span><span class="name type" title="Backend.Decl">Decl</span><span class="type">&nbsp;</span></dt><dd><p>A parametric type declaration (no definition, only name and parameters).</p>
<dl class="decls"><dt id="Backend.MkDecl"><span class="name constructor" title="Backend.MkDecl">MkDecl</span><span class="word">&nbsp;:&nbsp;</span><span class="signature">(<span class="documented boundvar" title="The name of the type.">name</span> : <a class="function" title="Types.Name" href="Types.html#Types.Name">Name</a>) ->
(<span class="documented boundvar" title="The names of the type&amp;#39;s parameters.">params</span> : <a class="type" title="Data.Vect.Vect" href="Data.Vect.html#Data.Vect.Vect">Vect</a> <span class="implicit boundvar" title="">n</span>
<a class="function" title="Types.Name" href="Types.html#Types.Name">Name</a>) ->
<a class="type" title="Backend.Decl" href="Backend.html#Backend.Decl">Decl</a></span></dt><dd><dl><dt>name</dt><dd><p>The name of the type.</p>
</dd><dt>params</dt><dd><p>The names of the type&#39;s parameters.</p>
</dd></dl></dd></dl><dl class="decls"><dt id="Backend.Decl.name"><span class="name function" title="Backend.Decl.name">name</span><span class="word">&nbsp;:&nbsp;</span><span class="signature">(<span class="boundvar" title="">rec</span> : <a class="type" title="Backend.Decl" href="Backend.html#Backend.Decl">Decl</a>) ->
<a class="function" title="Types.Name" href="Types.html#Types.Name">Name</a></span></dt><dd><p>The name of the type.</p>
</dd><dt id="Backend.Decl.params"><span class="name function" title="Backend.Decl.params">params</span><span class="word">&nbsp;:&nbsp;</span><span class="signature">(<span class="boundvar" title="">rec</span> : <a class="type" title="Backend.Decl" href="Backend.html#Backend.Decl">Decl</a>) ->
<a class="type" title="Data.Vect.Vect" href="Data.Vect.html#Data.Vect.Vect">Vect</a> (<a class="function" title="Backend.Decl.free_n" href="Backend.Decl.html#Backend.Decl.free_n">free_n</a> <span class="boundvar" title="">rec</span>)
<a class="function" title="Types.Name" href="Types.html#Types.Name">Name</a></span></dt><dd><p>The names of the type&#39;s parameters.</p>
</dd></dl></dd><dt id="Backend.Env"><span class="name function" title="Backend.Env">Env</span><span class="word">&nbsp;:&nbsp;</span><span class="signature"><a class="type" title="Prelude.Nat.Nat" href="Prelude.Nat.html#Prelude.Nat.Nat">Nat</a> ->
<span class="type" title="Type">Type</span></span></dt><dd><p>A variable environment. Left=free, Right=bound.</p>
</dd><dt id="Backend.MkDecl"><span class="name constructor" title="Backend.MkDecl">MkDecl</span><span class="word">&nbsp;:&nbsp;</span><span class="signature">(<span class="documented boundvar" title="The name of the type.">name</span> : <a class="function" title="Types.Name" href="Types.html#Types.Name">Name</a>) ->
(<span class="documented boundvar" title="The names of the type&amp;#39;s parameters.">params</span> : <a class="type" title="Data.Vect.Vect" href="Data.Vect.html#Data.Vect.Vect">Vect</a> <span class="implicit boundvar" title="">n</span>
<a class="function" title="Types.Name" href="Types.html#Types.Name">Name</a>) ->
<a class="type" title="Backend.Decl" href="Backend.html#Backend.Decl">Decl</a></span></dt><dd><dl><dt>name</dt><dd><p>The name of the type.</p>
</dd><dt>params</dt><dd><p>The names of the type&#39;s parameters.</p>
</dd></dl></dd><dt id="Backend.MkSpecialiseEntry"><span class="name constructor" title="Backend.MkSpecialiseEntry">MkSpecialiseEntry</span><span class="word">&nbsp;:&nbsp;</span><span class="signature">(<span class="boundvar" title="">tdef</span> : <a class="type" title="Typedefs.TDef" href="Typedefs.html#Typedefs.TDef">TDef</a> (<a class="function" title="Prelude.Interfaces.fromInteger" href="Prelude.Interfaces.html#Prelude.Interfaces.fromInteger">fromInteger</a> <span class="data" title="0">0</span>)) ->
(<span class="documented boundvar" title="name of type used for specialisation">targetType</span> : <span class="type" title="String">String</span>) ->
(<span class="documented boundvar" title="name of function of target type generateType tdef -&amp;gt; targetType">encodeFun</span> : <span class="type" title="String">String</span>) ->
(<span class="documented boundvar" title="name of function of target type targetType -&amp;gt; generateType tdef">decodeFun</span> : <span class="type" title="String">String</span>) ->
<a class="type" title="Backend.SpecialiseEntry" href="Backend.html#Backend.SpecialiseEntry">SpecialiseEntry</a></span></dt><dd><dl><dt>targetType</dt><dd><p>name of type used for specialisation</p>
</dd><dt>encodeFun</dt><dd><p>name of function of target type generateType tdef -&gt; targetType</p>
</dd><dt>decodeFun</dt><dd><p>name of function of target type targetType -&gt; generateType tdef</p>
</dd></dl></dd><dt id="Backend.SpecialiseEntry"><span class="word">record&nbsp;</span><span class="name type" title="Backend.SpecialiseEntry">SpecialiseEntry</span><span class="type">&nbsp;</span></dt><dd><dl class="decls"><dt id="Backend.MkSpecialiseEntry"><span class="name constructor" title="Backend.MkSpecialiseEntry">MkSpecialiseEntry</span><span class="word">&nbsp;:&nbsp;</span><span class="signature">(<span class="boundvar" title="">tdef</span> : <a class="type" title="Typedefs.TDef" href="Typedefs.html#Typedefs.TDef">TDef</a> (<a class="function" title="Prelude.Interfaces.fromInteger" href="Prelude.Interfaces.html#Prelude.Interfaces.fromInteger">fromInteger</a> <span class="data" title="0">0</span>)) ->
(<span class="documented boundvar" title="name of type used for specialisation">targetType</span> : <span class="type" title="String">String</span>) ->
(<span class="documented boundvar" title="name of function of target type generateType tdef -&amp;gt; targetType">encodeFun</span> : <span class="type" title="String">String</span>) ->
(<span class="documented boundvar" title="name of function of target type targetType -&amp;gt; generateType tdef">decodeFun</span> : <span class="type" title="String">String</span>) ->
<a class="type" title="Backend.SpecialiseEntry" href="Backend.html#Backend.SpecialiseEntry">SpecialiseEntry</a></span></dt><dd><dl><dt>targetType</dt><dd><p>name of type used for specialisation</p>
</dd><dt>encodeFun</dt><dd><p>name of function of target type generateType tdef -&gt; targetType</p>
</dd><dt>decodeFun</dt><dd><p>name of function of target type targetType -&gt; generateType tdef</p>
</dd></dl></dd></dl><dl class="decls"><dt id="Backend.SpecialiseEntry.tdef"><span class="name function" title="Backend.SpecialiseEntry.tdef">tdef</span><span class="word">&nbsp;:&nbsp;</span><span class="signature">(<span class="boundvar" title="">rec</span> : <a class="type" title="Backend.SpecialiseEntry" href="Backend.html#Backend.SpecialiseEntry">SpecialiseEntry</a>) ->
<a class="type" title="Typedefs.TDef" href="Typedefs.html#Typedefs.TDef">TDef</a> (<a class="function" title="Prelude.Interfaces.fromInteger" href="Prelude.Interfaces.html#Prelude.Interfaces.fromInteger">fromInteger</a> <span class="data" title="0">0</span>)</span></dt><dd></dd><dt id="Backend.SpecialiseEntry.targetType"><span class="name function" title="Backend.SpecialiseEntry.targetType">targetType</span><span class="word">&nbsp;:&nbsp;</span><span class="signature">(<span class="boundvar" title="">rec</span> : <a class="type" title="Backend.SpecialiseEntry" href="Backend.html#Backend.SpecialiseEntry">SpecialiseEntry</a>) ->
<span class="type" title="String">String</span></span></dt><dd><p>name of type used for specialisation</p>
</dd><dt id="Backend.SpecialiseEntry.encodeFun"><span class="name function" title="Backend.SpecialiseEntry.encodeFun">encodeFun</span><span class="word">&nbsp;:&nbsp;</span><span class="signature">(<span class="boundvar" title="">rec</span> : <a class="type" title="Backend.SpecialiseEntry" href="Backend.html#Backend.SpecialiseEntry">SpecialiseEntry</a>) ->
<span class="type" title="String">String</span></span></dt><dd><p>name of function of target type generateType tdef -&gt; targetType</p>
</dd><dt id="Backend.SpecialiseEntry.decodeFun"><span class="name function" title="Backend.SpecialiseEntry.decodeFun">decodeFun</span><span class="word">&nbsp;:&nbsp;</span><span class="signature">(<span class="boundvar" title="">rec</span> : <a class="type" title="Backend.SpecialiseEntry" href="Backend.html#Backend.SpecialiseEntry">SpecialiseEntry</a>) ->
<span class="type" title="String">String</span></span></dt><dd><p>name of function of target type targetType -&gt; generateType tdef</p>
</dd></dl></dd><dt id="Backend.freshEnvLC"><span class="name function" title="Backend.freshEnvLC">freshEnvLC</span><span class="word">&nbsp;:&nbsp;</span><span class="signature">(<span class="boundvar" title="">n</span> : <a class="type" title="Prelude.Nat.Nat" href="Prelude.Nat.html#Prelude.Nat.Nat">Nat</a>) ->
<a class="function" title="Backend.Env" href="Backend.html#Backend.Env">Env</a> <span class="boundvar" title="">n</span></span></dt><dd><p>Standard implmementation of <code>freshEnv</code> for languages that require type parameters to<br />
start with lower case letters (and allow numbers in names).</p>
</dd><dt id="Backend.freshEnvUC"><span class="name function" title="Backend.freshEnvUC">freshEnvUC</span><span class="word">&nbsp;:&nbsp;</span><span class="signature">(<span class="boundvar" title="">n</span> : <a class="type" title="Prelude.Nat.Nat" href="Prelude.Nat.html#Prelude.Nat.Nat">Nat</a>) ->
<a class="function" title="Backend.Env" href="Backend.html#Backend.Env">Env</a> <span class="boundvar" title="">n</span></span></dt><dd><p>Standard implmementation of <code>freshEnv</code> for languages that require type parameters to<br />
start with upper case letters (and allow numbers in names).</p>
</dd><dt id="Backend.generate"><span class="name function" title="Backend.generate">generate</span><span class="word">&nbsp;:&nbsp;</span><span class="signature">(<span class="boundvar" title="">lang</span> : <span class="type" title="Type">Type</span>) ->
<a class="type" title="Backend.Backend" href="Backend.html#Backend.Backend">Backend</a> <span class="boundvar" title="">lang</span> =>
<a class="type" title="Typedefs.TDef" href="Typedefs.html#Typedefs.TDef">TDef</a> <span class="implicit boundvar" title="">n</span> ->
<a class="type" title="Text.PrettyPrint.WL.Core.Doc" href="Text.PrettyPrint.WL.Core.html#Text.PrettyPrint.WL.Core.Doc">Doc</a></span></dt><dd><p>Generate code in a specific language for a type definition and all its dependencies.<br />
Needs to be called with the implicit parameter <code>lang</code>, as such: <code>generate {lang=Haskell} td</code>.</p>
</dd><dt id="Backend.generateDefsSpecialised"><span class="name function" title="Backend.generateDefsSpecialised">generateDefsSpecialised</span><span class="word">&nbsp;:&nbsp;</span><span class="signature"><a class="type" title="Backend.Backend" href="Backend.html#Backend.Backend">Backend</a> <span class="implicit boundvar" title="">lang</span> =>
<a class="type" title="Data.Vect.Vect" href="Data.Vect.html#Data.Vect.Vect">Vect</a> (<a class="constructor" title="Prelude.Nat.S" href="Prelude.Nat.html#Prelude.Nat.S">S</a> <span class="implicit boundvar" title="">m&#39;</span>)
<a class="type" title="Backend.SpecialiseEntry" href="Backend.html#Backend.SpecialiseEntry">SpecialiseEntry</a> ->
(<span class="boundvar" title="">n</span> : <a class="type" title="Prelude.Nat.Nat" href="Prelude.Nat.html#Prelude.Nat.Nat">Nat</a>) ->
<a class="type" title="Typedefs.TDef" href="Typedefs.html#Typedefs.TDef">TDef</a> <span class="boundvar" title="">n</span> ->
<a class="type" title="Prelude.List.List" href="Prelude.List.html#Prelude.List.List">List</a> <span class="implicit boundvar" title="">lang</span></span></dt><dd><p>Generate type definitions according to an <em>ordered</em> set of specialisation entries.</p>
</dd><dt id="Backend.getFreeVars"><span class="name function" title="Backend.getFreeVars">getFreeVars</span><span class="word">&nbsp;:&nbsp;</span><span class="signature">(<span class="boundvar" title="">e</span> : <a class="function" title="Backend.Env" href="Backend.html#Backend.Env">Env</a> <span class="implicit boundvar" title="">n</span>) ->
<a class="type" title="Data.Vect.Vect" href="Data.Vect.html#Data.Vect.Vect">Vect</a> (<a class="function" title="Prelude.Pairs.DPair.fst" href="Prelude.Pairs.DPair.html#Prelude.Pairs.DPair.fst">fst</a> (<a class="function" title="Data.Vect.filter" href="Data.Vect.html#Data.Vect.filter">filter</a> <a class="function" title="Prelude.Either.isLeft" href="Prelude.Either.html#Prelude.Either.isLeft">isLeft</a>
<span class="boundvar" title="">e</span>))
<span class="type" title="String">String</span></span></dt><dd><p>Get the free names from the environment.</p>
</dd><dt id="Backend.getUsedIndices"><span class="name function" title="Backend.getUsedIndices">getUsedIndices</span><span class="word">&nbsp;:&nbsp;</span><span class="signature"><a class="type" title="Typedefs.TDef" href="Typedefs.html#Typedefs.TDef">TDef</a> <span class="implicit boundvar" title="">n</span> ->
<a class="type" title="Prelude.List.List" href="Prelude.List.html#Prelude.List.List">List</a> (<a class="type" title="Data.Fin.Fin" href="Data.Fin.html#Data.Fin.Fin">Fin</a> <span class="implicit boundvar" title="">n</span>)</span></dt><dd><p>Get a list of the de Brujin indices that are actually used in a <code>TDef</code>.</p>
</dd><dt id="Backend.getUsedVars"><span class="name function" title="Backend.getUsedVars">getUsedVars</span><span class="word">&nbsp;:&nbsp;</span><span class="signature"><a class="function" title="Backend.Env" href="Backend.html#Backend.Env">Env</a> <span class="implicit boundvar" title="">n</span> ->
(<span class="boundvar" title="">td</span> : <a class="type" title="Typedefs.TDef" href="Typedefs.html#Typedefs.TDef">TDef</a> <span class="implicit boundvar" title="">n</span>) ->
<a class="function" title="Backend.Env" href="Backend.html#Backend.Env">Env</a> (<a class="function" title="Prelude.List.length" href="Prelude.List.html#Prelude.List.length">length</a> (<a class="function" title="Backend.getUsedIndices" href="Backend.html#Backend.getUsedIndices">getUsedIndices</a> <span class="boundvar" title="">td</span>))</span></dt><dd><p>Filter out the entries in an <code>Env</code> that is referred to by a <code>TDef</code>.</p>
</dd></dl></div></div><footer>Produced by IdrisDoc version 1.0</footer></body></html>